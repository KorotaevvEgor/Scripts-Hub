# Парсер вакансий "Инженер по охране труда" с hh.ru

Этот скрипт автоматически ищет вакансии "Инженер по охране труда" на сайте hh.ru и сохраняет результаты в Excel файл.

## Возможности

- Поиск вакансий только по точному совпадению в названии ("Инженер по охране труда")
- Сохранение результатов в Excel файл с колонками:
  - Номер
  - Название вакансии
  - Компания
  - Зарплата
  - Ссылка на вакансию
- Отслеживание новых вакансий: при повторном запуске новые вакансии попадают на лист "Новые вакансии", а ранее найденные - на лист "Предыдущие вакансии"
- Логирование всех операций в файл `hh_parser.log`

## Установка

1. Убедитесь, что у вас установлен Python 3.7 или выше
2. Установите необходимые библиотеки:

```bash
pip install -r requirements.txt
```

## Использование

Запустите скрипт:

```powershell
python hh_parser.py
```

**При первом запуске:** все найденные вакансии будут считаться новыми и попадут на лист "Новые вакансии".

**При повторных запусках:** скрипт сравнит текущие вакансии с предыдущими:
- Новые вакансии попадут на лист "Новые вакансии"
- Повторяющиеся вакансии попадут на лист "Предыдущие вакансии"

## Результаты

После выполнения скрипта будут созданы следующие файлы:

- `vacancies_safety_engineer.xlsx` - Excel файл с результатами поиска
- `previous_vacancies.json` - файл для отслеживания уже найденных вакансий
- `hh_parser.log` - лог файл с информацией о работе скрипта

## Структура Excel файла

### Лист "Новые вакансии"
Содержит вакансии, найденные в текущем запуске, которых не было в предыдущих поисках.

### Лист "Предыдущие вакансии" 
Содержит вакансии, которые уже встречались в предыдущих запусках.

## Настройка

Вы можете изменить следующие параметры в файле `hh_parser.py`:

- `search_text` - текст для поиска вакансий
- `pages` - количество страниц для просмотра (по умолчанию 5)
- `excel_file` - название Excel файла для сохранения результатов

## Примечания

- Скрипт использует официальный API hh.ru
- Между запросами к API добавлена пауза 0.5 сек для соблюдения лимитов
- Поиск ведется только по территории России
- Все ошибки записываются в лог файл для анализа
